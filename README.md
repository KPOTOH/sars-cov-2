# Activate environment (required python3.9)
```
cd sars-cov-2
python -m venv env
source env/bin/activate
pip install -r requirements.txt  # optional
pip install -e .
```



## Краткое описание работы

1. Выкачали Gisaid, только "качественное". Отфильтровали тех, что содержат что-либо кроме "ATGC". Получилось около 176 тыс. ковидов
2. Запустили пайплайн Константина:
    - выравнивание на референс (bwa)
    - (QC) оставили только последовательности из распределения, выбросы к черту
    - построение дерева (fasttree)
    - пруннинг дерева и разрешение его политомий, чтобы осталось ~50 тыс. ковидов
    - (QC) количественно проверили типы замен в дереве, много ToStop or FromStop, надо вычистить...
    - восстановление потомков дерева (prank)
3. Выделили замены из дерева. Для каждой замены известны: родитель на дереве, ребенок, позиция в геноме, нуклеотиды
4. Получили вторичную структуру генома ковида (экспериментальные данные из статьи в NAR)
5. Для каждой подходящей замены в датасете получили расстояние до ближайшей (по первичной стукруре и по вторичной) замены с учетом положения на дереве, т.е. считали в паре родитель-ребенок, и ее тип:
    - 0: комплементарные замены, приводящие к формированию комплементарных взаимодействий
    - 1: некомплементарные замены, разрушающие уже имеющиеся комплементарные взаимодействия
    - 2: замены, которые не восстанавливают комп. взаимодействия
    - 3: вне вторичных взаимодействий
    - 4: еще есть комплементарные, которые заново сформированы за 1 итерацию
6. Сравниваем распределения ближайших расстояний в поисках биологического смысла, они идентичны
7. Делаем интервальные статистики вдоль генома с помощью IW Tomics
8. Получаем результат



### Комментарии:

(5) В поисках расстояний и типов замен пробегались по массиву пар родитель-ребенок, в котором был список замен. Для каждой замены искали ближайшую замену в радиусе 1000 нуклеотидов и считали расстояние по первичке и по вторичке.


## Useful links
- NAR [paper](https://academic.oup.com/nar/advance-article/doi/10.1093/nar/gkaa1053/5961787)
- rna-tools [tutorial](https://rna-tools.readthedocs.io/en/latest/tools.html)
- cool RNA ss [visualization](http://rna.tbi.univie.ac.at/forna/)
- covid19 replication [paper 1](https://www.nature.com/articles/s41579-020-00468-6) and [2](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7122471/)
- life circle [paper](https://www.nature.com/articles/s41579-020-00468-6)
- ststistics decision tree [pingouin](https://pingouin-stats.org/guidelines.html?highlight=krus#non-parametric)
- []()
- []()

